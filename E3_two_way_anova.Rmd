---
title: "Two-way ANOVA example"
author: "Luis CÃ¡rceles"
date: "2024-04-12"
output: html_document
---

Examples taken from "Introduction to Probability and Statistics: Principles and Applications for Engineering and the Computing Sciences" By J. Susan Milton and Jesse Arnold, chapter 13.

### Example 1

The staff of a little transport system, with just five buses, need to test the wear of four types of tires. Each of the five buses are equipped with one of the four tires, randomly assigned. Each bus has a different route and the data of the wear are collected. Are the tires significantly different?

To answer this question, we construct the following hypothesis test:

-   $H_{0}$: $\mu_{1}=\mu_{2}=\mu_{3}=\mu_{4}$

-   $H_{1}$: $\mu_{i}\ne\mu_{j}$ for some $i$ and $j$

Data collection:

```{r}
V1<-c(9.1, 13.4, 15.6, 11.0, 12.7)
V2<-c(17.1, 20.3, 24.6, 18.2, 19.8)
V3<-c(20.8, 28.3, 23.7, 21.4, 25.1)
V4<-c(11.8, 16.0, 16.2, 14.1, 15.8)
Y<-c(V1, V2, V3, V4)
```

We define the categories for the treatments and the blocks:

```{r}
YcTr<-c("V1", "V1", "V1", "V1", "V1", "V2", "V2", "V2", "V2", "V2", "V3", "V3", "V3", "V3", "V3", "V4", "V4", "V4", "V4", "V4")
YcB<-c("1", "2", "3", "4", "5", "1", "2", "3", "4", "5", "1", "2", "3", "4", "5", "1", "2", "3", "4", "5")
```

Construct a new data frame:

```{r}
dataDF <- data.frame (
  Wear = Y,
  Tire = YcTr,
  Bus = YcB
)
```

Lets do some exploratory data analysis: Box plotting

```{r}
library(ggpubr)
ggboxplot(dataDF, x = "Tire", y = "Wear")
```

We can see the influence of the type of tire. To see the influence of the bus used to test the wear:

```{r}
 ggboxplot(dataDF, x = "Bus", y = "Wear")
```

To do the two-way analysis of variance:

```{r}
aov2 <- aov(lm(dataDF$Wear ~ dataDF$Tire + dataDF$Bus))
summary(aov2)
```

Therefore, we must reject null hypothesis, there is sufficient evidence to support alternative hypothesis. The populations generated by the treatments are different.

As F>>1, we also can say that the blocks (buses) no influence.

Lets examine the residuals:

```{r}
library(car)
qqPlot(aov2$residuals)
```
